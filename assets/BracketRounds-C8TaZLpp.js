import{j as s}from"./react-vendor-DmXkgcPG.js";import{u as I}from"./index-lbt8OJ0v.js";import{k as G,j as O,u as h,f as D}from"./swissUtils-B-w6T2sR.js";import{S}from"./ConfirmModal-p4Kc4V--.js";import{B as H}from"./Badge-DKL0jK-u.js";const $=({player:e,placement:r,seed:o,isWildCard:l,t:a})=>e?s.jsxs(s.Fragment,{children:[r&&s.jsx("span",{className:"mr-2 text-[10px] font-semibold text-[var(--color-muted)]",children:r}),o&&s.jsx("span",{className:"mr-2 text-[10px] font-semibold text-[var(--color-muted)]",children:o}),e.name,l&&s.jsx(H,{variant:"accent",className:"ml-2 text-[10px] px-1.5 py-0.5",children:a("groupStage.wildCardBadge")}),e.elo!=null&&s.jsx("span",{className:"ml-2 font-normal text-[10px] text-[var(--color-muted)]",children:a("players.elo",{elo:e.elo})})]}):null,L=({entries:e})=>s.jsx("span",{className:"text-[10px] text-[var(--color-faint)] font-mono whitespace-pre text-right",children:e.map((r,o)=>s.jsxs("span",{className:r.isWin?"font-semibold text-[var(--color-text)]":"",children:[o>0?" ":"",r.text]},o))}),E=({showPoints:e,setPointEntries:r,isWalkover:o,sets:l})=>s.jsxs("span",{className:"ml-2 text-[var(--color-muted)] flex items-center gap-2",children:[e&&r.length>0&&s.jsx(L,{entries:r}),s.jsx("span",{className:"text-[var(--color-faintest)]",children:"|"}),s.jsx("span",{className:"font-mono w-2 text-center",children:o?"WO":l})]}),k=(e,r)=>e?"?":r("bracket.bye"),q=({match:e,players:r,canEdit:o,onClick:l,wildCardIds:a,scoringMode:p=S.SETS,maxSets:m,roundIndex:x,groupPlacementByPlayerId:c,showSeedNumbers:i})=>{const{t:d}=I(),n=r.find(v=>v.id===e.player1Id),t=r.find(v=>v.id===e.player2Id),f=n&&a?.has(n.id),y=t&&a?.has(t.id),b=!e.player1Id||!e.player2Id,u=e.player1Id&&e.player2Id&&o,j=p===S.POINTS,{p1Sets:M,p2Sets:W}=G(e.scores,{scoringMode:p,maxSets:m}),w=e.walkover||O(e.scores),B=j?h(e.scores):[],T=j?h(e.scores,{swapped:!0}):[],N=x===0&&c,C=N&&n?c.get(n.id)??null:null,R=N&&t?c.get(t.id)??null:null,g=i&&x===0,_=g&&n?.seed!=null?String(n.seed):null,A=g&&t?.seed!=null?String(t.seed):null;return s.jsxs("div",{onClick:u?l:void 0,className:`border rounded-lg text-xs w-52 overflow-hidden bg-[var(--color-card)] transition-all duration-150 ${u?"cursor-pointer hover:border-[var(--color-primary)] hover:shadow-md hover:-translate-y-px":""} ${b?"opacity-40":"border-[var(--color-border)]"}`,role:u?"button":void 0,tabIndex:u?0:void 0,"aria-disabled":!u,"aria-label":u?d("bracket.editMatch"):void 0,onKeyDown:u?v=>{(v.key==="Enter"||v.key===" ")&&(v.preventDefault(),l&&l())}:void 0,children:[s.jsxs("div",{className:`flex items-center justify-between px-2 py-1.5 border-b border-[var(--color-border-soft)] ${e.winnerId===e.player1Id?"bg-[var(--color-soft)] font-semibold border-l-3 border-l-[var(--color-primary)]":""}`,children:[s.jsx("span",{className:"truncate flex-1",children:n?s.jsx($,{player:n,placement:C,seed:_,isWildCard:f,t:d}):k(e.player1Id,d)}),e.winnerId&&s.jsx(E,{showPoints:j,setPointEntries:B,isWalkover:w,sets:M})]}),s.jsxs("div",{className:`flex items-center justify-between px-2 py-1.5 ${e.winnerId===e.player2Id?"bg-[var(--color-soft)] font-semibold border-l-3 border-l-[var(--color-primary)]":""}`,children:[s.jsx("span",{className:"truncate flex-1",children:t?s.jsx($,{player:t,placement:R,seed:A,isWildCard:y,t:d}):k(e.player2Id,d)}),e.winnerId&&s.jsx(E,{showPoints:j,setPointEntries:T,isWalkover:w,sets:W})]})]})},K=64,P=8,U=({match:e,roundIndex:r,matchHeight:o,players:l,bracket:a,onEditMatch:p,scoringMode:m,maxSets:x,wildCardIds:c,canEditMatchFn:i,groupPlacementByPlayerId:d,showSeedNumbers:n})=>{if(e.dummy)return s.jsx("div",{className:"flex items-center invisible dummy",style:{height:`${o}px`}},`dummy-${r}-${e.position}`);const t=i?i(a,e.id):D(a,e.id);return s.jsx("div",{className:"flex items-center",style:{height:`${o}px`},children:s.jsx(q,{match:e,players:l,canEdit:t,wildCardIds:c,scoringMode:m,maxSets:x,roundIndex:r,groupPlacementByPlayerId:d,showSeedNumbers:n,onClick:()=>p?.(e)})})},z=({round:e,roundIndex:r,roundLabel:o,players:l,bracket:a,onEditMatch:p,scoringMode:m,maxSets:x,wildCardIds:c,canEditMatchFn:i,groupPlacementByPlayerId:d,showSeedNumbers:n})=>{const t=K*Math.pow(2,r),f=P*Math.pow(2,r),y=P/2*(Math.pow(2,r)-1);return s.jsxs("div",{className:"flex flex-col items-center",children:[s.jsx("div",{className:"text-xs font-semibold text-[var(--color-muted)] mb-3 whitespace-nowrap uppercase tracking-wider",children:o}),s.jsx("div",{className:"flex flex-col",style:{gap:`${f}px`,paddingTop:`${y}px`},children:e.map(b=>s.jsx(U,{match:b,roundIndex:r,matchHeight:t,players:l,bracket:a,onEditMatch:p,scoringMode:m,maxSets:x,wildCardIds:c,canEditMatchFn:i,groupPlacementByPlayerId:d,showSeedNumbers:n},b.dummy?`dummy-${r}-${b.position}`:b.id))})]})},Y=({bracket:e,players:r,onEditMatch:o,scoringMode:l,maxSets:a,wildCardIds:p,canEditMatchFn:m,groupPlacementByPlayerId:x,showSeedNumbers:c})=>{const{t:i}=I();if(!e)return null;const d=e.rounds.map((n,t)=>{const f=e.rounds.length;return t===f-1?i("bracket.final"):t===f-2?i("bracket.semifinals"):t===f-3?i("bracket.quarterfinals"):i("bracket.round",{n:t+1})});return s.jsx("div",{className:"overflow-x-auto pb-2",children:s.jsx("div",{className:"flex gap-1 items-start min-w-fit",children:e.rounds.map((n,t)=>s.jsx(z,{round:n,roundIndex:t,roundLabel:d[t],players:r,bracket:e,onEditMatch:o,scoringMode:l,maxSets:a,wildCardIds:p,canEditMatchFn:m,groupPlacementByPlayerId:x,showSeedNumbers:c},t))})})};export{Y as B,q as M};
